graph TD
    subgraph Intelligence Collection Module
        Supervisor["Intel Supervisor<br>分析覆盖率, 决定爬取策略"]

        subgraph Collection Agents
            direction LR
            Crawler["<b>Web Crawler Agent</b><br>- CVE/NVD<br>- MITRE<br>- GitHub<br>- HuggingFace"]
            Paper["<b>Paper Analyzer Agent</b><br>- arXiv<br>- 安全报告<br>- PoC代码"]
            DarkWeb["<b>Dark Web Agent</b><br>- 论坛<br>- TG群组"]
        end

        subgraph Processing Agent
             Standardizer["<b>Standardizer Agent</b><br>- 去重<br>- STIX 2.1<br>- 写入知识库"]
        end

        %% Control Flow: Supervisor tasks the collection agents
        Supervisor -- "下达采集策略" --> Crawler
        Supervisor -- "下达采集策略" --> Paper
        Supervisor -- "下达采集策略" --> DarkWeb
        
        %% Data Flow: Raw data is sent to the Standardizer
        Crawler -- "原始数据" --> Standardizer
        Paper -- "原始数据" --> Standardizer
        DarkWeb -- "原始数据" --> Standardizer

        %% Feedback Loop: Standardized data is reported back to the Supervisor
        Standardizer -- "标准化结果反馈" --> Supervisor
    end


    %% --- Styling Section ---
    classDef supervisor fill:#E1959A,color:#000000,stroke:#000000,stroke-width:2px
    classDef agent fill:#639DD0,color:#ffffff,stroke:#000000,stroke-width:2px
    classDef processor fill:#FFC79A,color:#000000,stroke:#000000,stroke-width:2px

    %% Applying Styles to Nodes
    class Supervisor supervisor
    class Crawler,Paper,DarkWeb agent
    class Standardizer processor